<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Emprunts</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container py-4">
        <h1 class="mb-4">Liste des emprunts</h1>

        <a href="{% url 'emprunt_ajouter' %}" class="btn btn-primary mb-3">Emprunter un média</a>

        {% if emprunts %}
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Membre</th>
                        <th>Média</th>
                        <th>Date d'emprunt</th>
                        <th>Date de retour</th>
                    </tr>
                </thead>
                <tbody>
                    {% for emprunt in emprunts %}
                        <tr>
                            <td>{{ emprunt.membre.nom }}</td>
                            <td>{{ emprunt.media.titre }}</td>
                            <td>{{ emprunt.date_emprunt }}</td>
                            <td>{{ emprunt.date_retour }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>Aucun emprunt en cours.</p>
        {% endif %}
    </div>

{% for emprunt in emprunts %}
    <p>
        {{ emprunt.membre }} a emprunté {{ emprunt.media }} jusqu’au {{ emprunt.date_retour }}
        {% if emprunt.date_retour >= today %}
            <!-- Bouton de retour -->
            <form action="{% url 'retour_emprunt' emprunt.id %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit">Retourner</button>
            </form>
        {% else %}
            (Retourné)
        {% endif %}
    </p>
{% endfor %}

</body>
</html>